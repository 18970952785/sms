<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.malicn.server.dao.bank.BankDao" >
  <resultMap id="bankMap" type="com.malicn.server.domain.bank.Bank" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="name" property="name" jdbcType="VARCHAR"/>
    <result column="short_name" property="shortName" jdbcType="VARCHAR"/>
    <result column="first_char" property="firstChar" jdbcType="VARCHAR"/>
    <result column="icon" property="icon" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="is_hot" property="isHot" jdbcType="TINYINT" />
    <result column="is_deleted" property="isDeleted" jdbcType="TINYINT" />
  </resultMap>

  <sql id="table_name">ml_bank</sql>
  <sql id="all_bank_columns">id,name,is_hot,short_name,first_char,icon,code,create_time,update_time,is_deleted</sql>


  <!--列举所有热门银行-->
  <select id="listHotBanks" resultMap="bankMap">
    SELECT <include refid="all_bank_columns"/> from ml_bank WHERE is_hot=1 AND is_deleted = 0 ORDER BY id
  </select>

  <!--列举所有银行-->
  <select id="listBanks" resultMap="bankMap">
    SELECT <include refid="all_bank_columns"/> from ml_bank WHERE is_deleted = 0 ORDER BY first_char ASC,convert(name USING gbk) COLLATE gbk_chinese_ci ASC, id ASC
  </select>

  <!--查找银行-->
  <select id="searchBank" parameterType="string" resultMap="bankMap">
    SELECT <include refid="all_bank_columns"/> from ml_bank WHERE name like CONCAT('%', #{keyword}, '%') AND is_deleted = 0
  </select>


  <select id="getBankMapByList"  resultMap="bankMap"  parameterType="java.util.List">
    select
    <include refid="all_bank_columns"/>
    from ml_bank
    where id in
    <foreach item="item" collection="list" open="(" separator="," close=")">
      #{item.bankId}
    </foreach>
    and is_deleted=0
  </select>

  <select id="getBankNameMapByList"  resultMap="bankMap"  parameterType="java.util.List">
    select
    <include refid="all_bank_columns"/>
    from ml_bank
    where id in
    <foreach item="item" collection="list" open="(" separator="," close=")">
      #{item.bankCardId}
    </foreach>
    and is_deleted=0
  </select>



  <!--查找银行-->
  <select id="getBankMapById" resultMap="bankMap">
    SELECT <include refid="all_bank_columns"/> from ml_bank
    WHERE id=#{Id} AND is_deleted = 0
  </select>

</mapper>