<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.malicn.server.dao.cloudStorage.CloudStorageFileDao" >
  <resultMap id="BaseResultMap" type="com.malicn.server.domain.cloudStorage.CloudStorageFile" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="storage_id" property="storageId" jdbcType="BIGINT" />
    <result column="file_url" property="fileUrl" jdbcType="VARCHAR" />
    <result column="file_class" property="fileClass" jdbcType="TINYINT" />
    <result column="creator" property="creator" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="updator" property="updator" jdbcType="INTEGER" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, storage_id, file_url, file_class, creator, create_time, updator, update_time
  </sql>

  <select id="getBystorageId" parameterType="java.lang.Long" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" /> from yc_storage_file where storage_id=#{storageId}
  </select>


  <insert id="insertCloudStroageFile" parameterType="java.util.List">
    INSERT INTO yc_storage_file ( storage_id, file_url, file_class, creator, create_time, updator)
    VALUES
    <foreach collection="list" index="index" item="item" separator=",">
      (#{item.storageId}, #{item.fileUrl}, #{item.fileClass},
      #{item.creator}, now(), #{item.updator})
    </foreach>
  </insert>

  <insert id="insertOneCloud">
      INSERT INTO yc_storage_file ( storage_id, file_url, file_class, creator, create_time, updator)
      VALUES (#{storageId},#{fileUrl}, #{fileClass},#{creator}, now(), #{updator})
  </insert>

  <update id="updateCloudFileUrl">
    UPDATE yc_storage_file SET    file_url=#{fileUrl} where storage_id=#{storageId} and file_class=#{fileClass}
  </update>

  <select id="selectByOne" resultType="com.malicn.server.domain.cloudStorage.CloudStorageFile">
    SELECT <include refid="Base_Column_List" /> from yc_storage_file where
    storage_id=#{storageId} and file_class=#{fileClass}
  </select>
  <select id="selectImages" resultType="java.lang.String">
    SELECT file_url FROM yc_storage_file where storage_id = #{storageId} and file_class in(5,6,7,8,9)
  </select>

</mapper>